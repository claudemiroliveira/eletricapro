<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0a1628">
  <meta name="description" content="App profissional para c√°lculos el√©tricos, tabelas t√©cnicas, instala√ß√µes e or√ßamentos">
  <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
  
  <title>El√©trica Pro</title>
  <style>
    /* ===== RESET & ROOT ===== */
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

    :root {
      --blue-deep:  #0a1628;
      --blue-mid:   #0d2347;
      --blue-bright:#1565c0;
      --blue-light: #1976d2;
      --blue-glow:  #2196f3;
      --yellow:     #ffd600;
      --yellow-soft:#ffca28;
      --white:      #ffffff;
      --card-bg:    rgba(13,35,71,0.85);
      --card-border:rgba(33,150,243,0.35);
      --text-muted: rgba(255,255,255,0.65);
      --success:    #4caf50;
      --danger:     #f44336;
      --warning:    #ff9800;
      --radius:     14px;
      --trans:      0.3s ease;
    }

    /* ===== BODY & STARS ===== */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--blue-deep);
      color: var(--white);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Animated starfield */
    #stars-canvas {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    /* ===== HEADER ===== */
    .app-header {
      position: sticky; top: 0; z-index: 200;
      background: linear-gradient(135deg, var(--blue-mid) 0%, var(--blue-deep) 100%);
      border-bottom: 1px solid var(--card-border);
      backdrop-filter: blur(12px);
      padding: 0.9rem 1.4rem;
      display: flex; align-items: center; gap: 0.9rem;
      box-shadow: 0 4px 24px rgba(0,0,0,0.4);
    }
    .logo-circle {
      width: 46px; height: 46px; flex-shrink: 0;
      border-radius: 50%;
      border: 2px solid var(--yellow);
      display: flex; align-items: center; justify-content: center;
      background: rgba(255,214,0,0.08);
      box-shadow: 0 0 14px rgba(255,214,0,0.4);
      animation: pulseLogo 2.5s ease-in-out infinite;
    }
    .logo-circle svg { width:26px; height:26px; }
    @keyframes pulseLogo {
      0%,100%{ box-shadow: 0 0 14px rgba(255,214,0,0.4); }
      50%    { box-shadow: 0 0 28px rgba(255,214,0,0.8); }
    }
    .header-text h1 {
      font-size: 1.35rem; font-weight: 700; letter-spacing: 0.5px;
    }
    .header-text h1 span { color: var(--yellow); }
    .header-text p  { font-size: 0.78rem; color: var(--text-muted); }

    /* Back button inside header */
    .btn-back {
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.15);
      color: white; padding: 0.5rem 1rem;
      border-radius: 8px; cursor: pointer;
      font-size: 0.9rem; transition: var(--trans);
      display: flex; align-items: center; gap: 0.4rem;
    }
    .btn-back:hover { background: rgba(255,255,255,0.18); }

    /* Trial banner */
    #trialBanner {
      background: linear-gradient(135deg, #e65100 0%, #bf360c 100%);
      text-align: center; padding: 0.55rem 1rem;
      font-size: 0.85rem; font-weight: 600; position: relative; z-index: 100;
    }

    /* ===== MAIN CONTAINER ===== */
    .container {
      position: relative; z-index: 10;
      max-width: 960px; margin: 0 auto; padding: 1.5rem 1rem 4rem;
    }

    /* ===== SCREENS ===== */
    .screen { display: none; }
    .screen.active {
      display: block;
      animation: slideUp 0.35s ease-out;
    }
    @keyframes slideUp {
      from { opacity:0; transform:translateY(20px); }
      to   { opacity:1; transform:translateY(0); }
    }

    /* ===== HERO (home screen) ===== */
    .hero {
      text-align: center; padding: 2rem 1rem 1.5rem;
    }
    .hero-logo {
      width: 100px; height: 100px; margin: 0 auto 1.2rem;
      border-radius: 50%;
      border: 3px solid var(--yellow);
      display: flex; align-items: center; justify-content: center;
      background: radial-gradient(circle, rgba(255,214,0,0.15) 0%, transparent 70%);
      box-shadow: 0 0 40px rgba(255,214,0,0.35);
    }
    .hero-logo svg { width: 60px; height: 60px; }
    .hero h2 { font-size: 2.2rem; font-weight: 800; letter-spacing: 1px; }
    .hero h2 span { color: var(--yellow); }
    .hero p  { color: var(--text-muted); margin-top: 0.4rem; font-size: 0.95rem; }

    /* ===== GRID DE √çCONES ===== */
    .icon-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-top: 2rem;
    }
    @media(max-width:520px) {
      .icon-grid { grid-template-columns: repeat(2, 1fr); }
    }

    .icon-tile {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 1.4rem 0.8rem 1.1rem;
      text-align: center;
      cursor: pointer;
      transition: var(--trans);
      backdrop-filter: blur(8px);
      position: relative; overflow: hidden;
    }
    .icon-tile::before {
      content:'';
      position:absolute; inset:0;
      background: linear-gradient(135deg, rgba(33,150,243,0.08) 0%, transparent 60%);
      opacity: 0; transition: var(--trans);
    }
    .icon-tile:hover::before { opacity:1; }
    .icon-tile:hover {
      transform: translateY(-5px) scale(1.03);
      box-shadow: 0 12px 32px rgba(33,150,243,0.25);
      border-color: var(--blue-glow);
    }
    .icon-tile:active { transform: scale(0.96); }

    .tile-icon {
      width: 60px; height: 60px; margin: 0 auto 0.75rem;
      border-radius: 16px;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.9rem;
      background: linear-gradient(135deg, var(--blue-bright), var(--blue-glow));
      box-shadow: 0 6px 18px rgba(33,150,243,0.3);
      transition: var(--trans);
    }
    .icon-tile:hover .tile-icon {
      box-shadow: 0 8px 28px rgba(33,150,243,0.55);
    }
    .tile-label {
      font-size: 0.82rem; font-weight: 600; color: var(--white);
      letter-spacing: 0.3px; line-height: 1.3;
    }

    /* ===== SUB-MENU GRID (para telas internas) ===== */
    .sub-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem; margin-top: 1.2rem;
    }
    @media(max-width:400px){ .sub-grid { grid-template-columns: 1fr; } }

    .sub-tile {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 1.2rem 1rem;
      cursor: pointer; transition: var(--trans);
      display: flex; align-items: center; gap: 0.9rem;
    }
    .sub-tile:hover {
      transform: translateX(4px);
      border-color: var(--blue-glow);
      background: rgba(21,101,192,0.25);
    }
    .sub-tile .s-icon {
      font-size: 1.6rem; flex-shrink: 0;
      width: 46px; height: 46px;
      background: linear-gradient(135deg, var(--blue-bright), var(--blue-glow));
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
    }
    .sub-tile .s-text strong { display:block; font-size:0.95rem; }
    .sub-tile .s-text span  { font-size:0.77rem; color:var(--text-muted); }

    /* ===== SCREEN TITLE ===== */
    .screen-title {
      font-size: 1.3rem; font-weight: 700; margin: 0.6rem 0 1.2rem;
      display: flex; align-items: center; gap: 0.6rem;
    }
    .screen-title .dot {
      width: 4px; height: 1.3rem; border-radius: 2px;
      background: var(--yellow);
    }

    /* ===== CALC CARD ===== */
    .calc-card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-bottom: 1.2rem;
      backdrop-filter: blur(8px);
    }
    .calc-card h3 {
      font-size: 1rem; font-weight: 700;
      margin-bottom: 1.2rem; color: var(--yellow-soft);
      display: flex; align-items: center; gap: 0.4rem;
    }

    /* ===== FORM ===== */
    .form-group { margin-bottom: 1.1rem; }
    .form-group label {
      display:block; margin-bottom:0.4rem;
      font-size:0.88rem; color:var(--text-muted); font-weight:500;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width:100%; padding:0.75rem 0.9rem;
      background: rgba(255,255,255,0.06);
      border: 1.5px solid rgba(33,150,243,0.3);
      border-radius: 9px;
      color: white; font-size:0.95rem;
      transition: var(--trans);
      -webkit-appearance: none;
    }
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--blue-glow);
      background: rgba(33,150,243,0.1);
      box-shadow: 0 0 0 3px rgba(33,150,243,0.15);
    }
    .form-group select option { background: var(--blue-mid); color: white; }

    /* ===== BUTTONS ===== */
    .btn {
      display: inline-flex; align-items: center; gap: 0.4rem;
      background: linear-gradient(135deg, var(--blue-bright), var(--blue-glow));
      color: white; border: none;
      padding: 0.8rem 1.6rem;
      border-radius: 9px; font-size: 0.95rem; font-weight: 600;
      cursor: pointer; transition: var(--trans);
      margin-right: 0.5rem; margin-bottom: 0.5rem;
      box-shadow: 0 4px 14px rgba(33,150,243,0.3);
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 22px rgba(33,150,243,0.5);
    }
    .btn-yellow {
      background: linear-gradient(135deg, #f9a825, #ffd600);
      color: #0a1628;
      box-shadow: 0 4px 14px rgba(255,214,0,0.3);
    }
    .btn-yellow:hover { box-shadow: 0 8px 22px rgba(255,214,0,0.5); }
    .btn-green {
      background: linear-gradient(135deg,#388e3c,#4caf50);
      box-shadow: 0 4px 14px rgba(76,175,80,0.3);
    }
    .btn-red {
      background: linear-gradient(135deg,#c62828,#f44336);
      box-shadow: 0 4px 14px rgba(244,67,54,0.3);
      padding: 0.4rem 0.8rem; font-size: 0.82rem;
    }

    /* ===== RESULT BOX ===== */
    .result-box {
      margin-top: 1.2rem;
      background: rgba(21,101,192,0.18);
      border: 1px solid rgba(33,150,243,0.4);
      border-radius: 10px; padding: 1.2rem;
    }
    .result-box h4 { color: var(--yellow-soft); margin-bottom: 0.8rem; font-size:0.9rem; }
    .result-item {
      display: flex; justify-content: space-between; align-items: center;
      padding: 0.45rem 0;
      border-bottom: 1px solid rgba(33,150,243,0.2);
      font-size: 0.9rem;
    }
    .result-item:last-child { border-bottom: none; }
    .result-item span { color: var(--text-muted); }
    .result-item strong { color: var(--white); }

    /* ===== TABLES ===== */
    .table-responsive { overflow-x: auto; margin-top:0.8rem; border-radius:10px; }
    table { width:100%; border-collapse:collapse; }
    thead tr { background: linear-gradient(135deg, var(--blue-bright), var(--blue-glow)); }
    th { padding:0.75rem 0.9rem; text-align:left; font-size:0.85rem; font-weight:600; color:white; }
    td { padding:0.7rem 0.9rem; font-size:0.88rem; color:rgba(255,255,255,0.85); border-bottom:1px solid rgba(33,150,243,0.12); }
    tr:hover td { background: rgba(33,150,243,0.1); }

    /* ===== TABS ===== */
    .tabs {
      display: flex; flex-wrap: wrap; gap: 0.5rem;
      margin-bottom: 1.2rem;
    }
    .tab {
      padding: 0.55rem 1.1rem;
      background: rgba(255,255,255,0.06);
      border: 1.5px solid rgba(33,150,243,0.25);
      border-radius: 8px; cursor: pointer;
      font-size: 0.85rem; transition: var(--trans);
    }
    .tab.active {
      background: linear-gradient(135deg, var(--blue-bright), var(--blue-glow));
      border-color: var(--blue-glow);
      box-shadow: 0 4px 14px rgba(33,150,243,0.3);
    }
    .tab:hover:not(.active) { border-color: var(--blue-glow); background: rgba(33,150,243,0.1); }

    /* ===== OR√áAMENTO ===== */
    .orcamento-item {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(33,150,243,0.2);
      border-radius: 10px; padding: 0.9rem 1rem;
      margin-bottom: 0.7rem;
      display: flex; justify-content: space-between; align-items: center;
    }
    .orcamento-item strong { display:block; font-size:0.9rem; }
    .orcamento-item small  { font-size:0.78rem; color:var(--text-muted); }
    .total-box {
      background: linear-gradient(135deg,#2e7d32,#43a047);
      border-radius:10px; padding:1.1rem;
      text-align:center; font-size:1.1rem; font-weight:700;
      margin-top:0.8rem;
      box-shadow: 0 6px 18px rgba(76,175,80,0.25);
    }

    /* ===== CONSUMO SECTION ===== */
    #consumoScreen .calc-card { }
    .consumo-item-row {
      display:flex; gap:0.5rem; flex-wrap:wrap; margin-bottom:0.6rem; align-items:flex-end;
    }
    .consumo-item-row .form-group { flex:1; min-width:120px; margin-bottom:0; }
    .consumo-result-summary {
      background: rgba(255,214,0,0.1);
      border: 1px solid rgba(255,214,0,0.35);
      border-radius:10px; padding:1.2rem;
      margin-top:1rem;
    }
    .consumo-result-summary h4 { color:var(--yellow-soft); margin-bottom:0.8rem; font-size:0.9rem; }
    .consumo-big { font-size:2rem; font-weight:800; color:var(--yellow); text-align:center; margin:0.5rem 0; }
    .consumo-big span { font-size:1rem; font-weight:400; color:var(--text-muted); }

    /* ===== INSTALA√á√ïES ===== */
    .install-item {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      margin-bottom: 1rem; overflow:hidden;
    }
    .install-header {
      background: linear-gradient(135deg, rgba(21,101,192,0.5), rgba(13,35,71,0.8));
      padding: 1rem 1.2rem;
      cursor: pointer;
      display: flex; justify-content: space-between; align-items: center;
      transition: var(--trans);
    }
    .install-header:hover { background: rgba(33,150,243,0.2); }
    .install-header h4 { font-size:0.95rem; font-weight:700; display:flex;gap:0.5rem;align-items:center; }
    .install-chevron { transition: transform 0.3s; font-size:0.8rem; }
    .install-item.open .install-chevron { transform: rotate(180deg); }
    .install-body {
      display:none; padding:1.2rem;
      border-top:1px solid var(--card-border);
    }
    .install-item.open .install-body { display:block; }
    .install-body p  { font-size:0.88rem; color:rgba(255,255,255,0.8); line-height:1.7; margin-bottom:0.6rem; }
    .install-body ul { padding-left:1.2rem; }
    .install-body ul li { font-size:0.87rem; color:rgba(255,255,255,0.75); line-height:1.7; }
    .install-body h5 { color:var(--yellow-soft); margin:0.8rem 0 0.4rem; font-size:0.88rem; }

    /* ===== SCROLLBAR ===== */
    ::-webkit-scrollbar { width:5px; background:var(--blue-deep); }
    ::-webkit-scrollbar-thumb { background:var(--blue-bright); border-radius:4px; }
  </style>
</head>
<body>

<!-- Animated stars -->
<canvas id="stars-canvas"></canvas>

<!-- Trial Banner -->
<div id="trialBanner">üéÅ Per√≠odo de teste: <span id="daysLeft">7</span> dias restantes</div>

<!-- Header -->
<header class="app-header" id="appHeader">
  <div id="headerBack" style="display:none;">
    <button class="btn-back" onclick="goHome()">‚Üê Voltar</button>
  </div>
  <div class="logo-circle">
    <svg viewBox="0 0 24 24" fill="none">
      <polygon points="13,2 4.5,13.5 11,13.5 11,22 19.5,10.5 13,10.5" fill="#FFD600"/>
    </svg>
  </div>
  <div class="header-text" style="flex:1;">
    <h1>El√©trica<span>Pro</span></h1>
    <p id="headerSubtitle">Calculadoras, Tabelas e Instala√ß√µes</p>
  </div>
  <button id="darkModeBtn" onclick="toggleDarkMode()" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);color:white;padding:0.4rem 0.8rem;border-radius:8px;cursor:pointer;font-size:0.8rem;white-space:nowrap;">‚òÄÔ∏è Modo Claro</button>
</header>

<div class="container">

  <!-- ========== TELA INICIAL ========== -->
  <div id="homeScreen" class="screen active">
    <div class="hero">
      <div class="hero-logo">
        <svg viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="11" stroke="#FFD600" stroke-width="1.5"/>
          <polygon points="13,2 4.5,13.5 11,13.5 11,22 19.5,10.5 13,10.5" fill="#FFD600"/>
        </svg>
      </div>
      <h2>El√©trica<span>Pro</span></h2>
      <p>Ferramentas profissionais para eletricistas</p>
    </div>

    <div class="icon-grid">
      <div class="icon-tile" onclick="openScreen('calculadorasHome', 'Calculadoras')">
        <div class="tile-icon">üßÆ</div>
        <div class="tile-label">Calculadoras</div>
      </div>
      <div class="icon-tile" onclick="openScreen('tabelasHome', 'Tabelas')">
        <div class="tile-icon">üìä</div>
        <div class="tile-label">Tabelas</div>
      </div>
      <div class="icon-tile" onclick="openScreen('instalacoes', 'Instala√ß√µes')">
        <div class="tile-icon">üîå</div>
        <div class="tile-label">Instala√ß√µes</div>
      </div>
      <div class="icon-tile" onclick="openScreen('consumo', 'Consumo')">
        <div class="tile-icon">‚ö°</div>
        <div class="tile-label">Consumo</div>
      </div>
      <div class="icon-tile" onclick="openScreen('orcamentos', 'Or√ßamentos')">
        <div class="tile-icon">üí∞</div>
        <div class="tile-label">Or√ßamentos</div>
      </div>
      <div class="icon-tile" onclick="openScreen('normas', 'Normas')">
        <div class="tile-icon">üìã</div>
        <div class="tile-label">Normas</div>
      </div>
    </div>
  </div>

  <!-- ========== CALCULADORAS HOME ========== -->
  <div id="calculadorasHome" class="screen">
    <div class="screen-title"><div class="dot"></div>Calculadoras</div>
    <div class="sub-grid">
      <div class="sub-tile" onclick="openScreen('calcLeiOhm','Lei de Ohm')">
        <div class="s-icon">üîå</div>
        <div class="s-text"><strong>Lei de Ohm</strong><span>V = I √ó R</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('calcPotencia','Pot√™ncia')">
        <div class="s-icon">‚ö°</div>
        <div class="s-text"><strong>Pot√™ncia</strong><span>P, Q, S</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('calcQueda','Queda de Tens√£o')">
        <div class="s-icon">üìâ</div>
        <div class="s-text"><strong>Queda de Tens√£o</strong><span>M√°x 4%</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('calcCondutor','Dimensionamento')">
        <div class="s-icon">üìè</div>
        <div class="s-text"><strong>Dimensionamento</strong><span>Condutor & Disjuntor</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('calcConversao','Convers√£o de Unidades'); updateUnidades();">
        <div class="s-icon">üîÑ</div>
        <div class="s-text"><strong>Convers√£o</strong><span>W, kW, CV, V, A...</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('calcIluminacao','Ilumina√ß√£o')">
        <div class="s-icon">üí°</div>
        <div class="s-text"><strong>Ilumina√ß√£o</strong><span>Lux, Lumin√°rias</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('calcCurtoCircuito','Curto-Circuito')">
        <div class="s-icon">‚ö°</div>
        <div class="s-text"><strong>Curto-Circuito</strong><span>Icc, Poder de Corte</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('calcFatorDemanda','Fator de Demanda')">
        <div class="s-icon">üìä</div>
        <div class="s-text"><strong>Fator de Demanda</strong><span>Demanda M√°xima</span></div>
      </div>
    </div>
  </div>

  <!-- ========== CALC: LEI DE OHM ========== -->
  <div id="calcLeiOhm" class="screen">
    <div class="screen-title"><div class="dot"></div>Lei de Ohm</div>
    <div class="calc-card">
      <h3>üîå Lei de Ohm (V = I √ó R)</h3>
      <p style="font-size:0.82rem;color:var(--text-muted);margin-bottom:1rem;">Preencha 2 dos 3 campos. O terceiro ser√° calculado.</p>
      <div class="form-group"><label>Tens√£o (V ‚Äî Volts):</label><input type="number" id="tensaoOhm" placeholder="Ex: 220"></div>
      <div class="form-group"><label>Corrente (I ‚Äî Amperes):</label><input type="number" id="correnteOhm" placeholder="Ex: 10"></div>
      <div class="form-group"><label>Resist√™ncia (R ‚Äî Ohms):</label><input type="number" id="resistenciaOhm" placeholder="Ex: 22"></div>
      <button class="btn" onclick="calcularLeiOhm()">‚ö° Calcular</button>
      <button class="btn btn-yellow" onclick="gerarPDFCalc('Lei de Ohm')">üìÑ PDF</button>
      <div id="resultLeiOhm"></div>
    </div>
  </div>

  <!-- ========== CALC: POT√äNCIA ========== -->
  <div id="calcPotencia" class="screen">
    <div class="screen-title"><div class="dot"></div>Pot√™ncia El√©trica</div>
    <div class="calc-card">
      <h3>‚ö° C√°lculo de Pot√™ncia</h3>
      <div class="form-group"><label>Tens√£o (V ‚Äî Volts):</label><input type="number" id="tensaoPot" placeholder="Ex: 220"></div>
      <div class="form-group"><label>Corrente (A ‚Äî Amperes):</label><input type="number" id="correntePot" placeholder="Ex: 10"></div>
      <div class="form-group"><label>Fator de Pot√™ncia (cos œÜ):</label><input type="number" id="fatorPot" placeholder="Ex: 0.92" step="0.01" value="0.92"></div>
      <div class="form-group"><label>Tipo de Circuito:</label>
        <select id="tipoCircuito">
          <option value="monofasico">Monof√°sico</option>
          <option value="trifasico">Trif√°sico</option>
        </select>
      </div>
      <button class="btn" onclick="calcularPotencia()">‚ö° Calcular</button>
      <button class="btn btn-yellow" onclick="gerarPDFCalc('Pot√™ncia')">üìÑ PDF</button>
      <div id="resultPotencia"></div>
    </div>
  </div>

  <!-- ========== CALC: QUEDA DE TENS√ÉO ========== -->
  <div id="calcQueda" class="screen">
    <div class="screen-title"><div class="dot"></div>Queda de Tens√£o</div>
    <div class="calc-card">
      <h3>üìâ Queda de Tens√£o</h3>
      <div class="form-group"><label>Corrente (A):</label><input type="number" id="correnteQueda" placeholder="Ex: 20"></div>
      <div class="form-group"><label>Dist√¢ncia do circuito (m):</label><input type="number" id="distanciaQueda" placeholder="Ex: 50"></div>
      <div class="form-group"><label>Se√ß√£o do condutor (mm¬≤):</label>
        <select id="secaoQueda">
          <option value="1.5">1,5 mm¬≤</option><option value="2.5">2,5 mm¬≤</option>
          <option value="4">4 mm¬≤</option><option value="6">6 mm¬≤</option>
          <option value="10">10 mm¬≤</option><option value="16">16 mm¬≤</option>
          <option value="25">25 mm¬≤</option><option value="35">35 mm¬≤</option>
          <option value="50">50 mm¬≤</option>
        </select>
      </div>
      <div class="form-group"><label>Tens√£o do circuito (V):</label><input type="number" id="tensaoQueda" placeholder="Ex: 220" value="220"></div>
      <button class="btn" onclick="calcularQuedaTensao()">‚ö° Calcular</button>
      <button class="btn btn-yellow" onclick="gerarPDFCalc('Queda de Tens√£o')">üìÑ PDF</button>
      <div id="resultQuedaTensao"></div>
    </div>
  </div>

  <!-- ========== CALC: DIMENSIONAMENTO ========== -->
  <div id="calcCondutor" class="screen">
    <div class="screen-title"><div class="dot"></div>Dimensionamento de Condutor</div>
    <div class="calc-card">
      <h3>üìè Dimensionamento de Condutor</h3>
      <div class="form-group"><label>Pot√™ncia (W):</label><input type="number" id="potenciaCondutor" placeholder="Ex: 5500"></div>
      <div class="form-group"><label>Tens√£o (V):</label><input type="number" id="tensaoCondutor" placeholder="Ex: 220" value="220"></div>
      <div class="form-group"><label>Dist√¢ncia (m):</label><input type="number" id="distanciaCondutor" placeholder="Ex: 30"></div>
      <div class="form-group"><label>Tipo de instala√ß√£o:</label>
        <select id="tipoInstalacao">
          <option value="B1">B1 ‚Äî Eletrodutos em parede</option>
          <option value="B2">B2 ‚Äî Cabo multipolar em parede</option>
          <option value="C">C ‚Äî Cabo multipolar ao ar livre</option>
        </select>
      </div>
      <button class="btn" onclick="dimensionarCondutor()">‚ö° Dimensionar</button>
      <button class="btn btn-yellow" onclick="gerarPDFCalc('Dimensionamento')">üìÑ PDF</button>
      <div id="resultCondutor"></div>
    </div>
  </div>
  
<!-- ========== CALC: CONVERS√ïES ========== -->
<div id="calcConversao" class="screen">
  <div class="screen-title">
    <div class="dot"></div>Convers√µes El√©tricas
  </div>

  <div class="calc-card">
    <h3>üîÑ Conversor de Unidades</h3>

    <div class="form-group">
      <label>Tipo de Convers√£o:</label>
      <select id="tipoConversao" onchange="updateUnidades()">
        <option value="potencia">Pot√™ncia (W / kW / CV / MW)</option>
        <option value="tensao">Tens√£o (V / kV / mV / ¬µV)</option>
        <option value="corrente">Corrente (A / mA / kA / ¬µA)</option>
        <option value="resistencia">Resist√™ncia (Œ© / kŒ© / MŒ©)</option>
        <option value="energia">Energia (kWh / Wh / J / kcal)</option>
        <option value="bitola">Bitola (mm¬≤ ‚Üî AWG)</option>
      </select>
    </div>

    <div class="form-group">
      <label>Valor:</label>
      <input type="number" id="valorConversao" placeholder="Digite o valor">
    </div>

    <div class="form-group">
      <label>Unidade:</label>
      <select id="unidadeConversao"></select>
    </div>

    <button class="btn" onclick="calcularConversao()">‚ö° Converter</button>

    <div id="resultConversao"></div>
  </div>
</div>
  
  


  <!-- ========== CALC: ILUMINA√á√ÉO ========== -->
  <div id="calcIluminacao" class="screen">
    <div class="screen-title"><div class="dot"></div>C√°lculo de Ilumina√ß√£o</div>
    <div class="calc-card">
      <h3>üí° Dimensionamento de Ilumina√ß√£o (NBR ISO/CIE 8995-1)</h3>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;">
        <div class="form-group">
          <label>√Årea do ambiente (m¬≤):</label>
          <input type="number" id="areaIlum" placeholder="Ex: 20">
        </div>
        <div class="form-group">
          <label>Altura do teto (m):</label>
          <input type="number" id="alturaIlum" placeholder="Ex: 2.80" step="0.1">
        </div>
      </div>
      <div class="form-group">
        <label>Tipo de Ambiente:</label>
        <select id="tipoAmbienteIlum">
          <option value="sala">Sala de Estar (200 lux)</option>
          <option value="quarto">Quarto (100 lux)</option>
          <option value="cozinha">Cozinha (300 lux)</option>
          <option value="escritorio">Escrit√≥rio (500 lux)</option>
          <option value="banheiro">Banheiro (200 lux)</option>
          <option value="garagem">Garagem (75 lux)</option>
          <option value="corredor">Corredor (100 lux)</option>
          <option value="externo">√Årea Externa (50 lux)</option>
        </select>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;">
        <div class="form-group">
          <label>Fluxo luminoso da l√¢mpada (lm):</label>
          <input type="number" id="fluxoLamp" placeholder="Ex: 800 (LED 9W)">
        </div>
        <div class="form-group">
          <label>Plano de trabalho (m):</label>
          <input type="number" id="planoTrabalho" placeholder="0.75" value="0.75" step="0.05">
        </div>
      </div>
      <div class="form-group">
        <label>Efici√™ncia da lumin√°ria (Fu estimado 0,5‚Äì0,9):</label>
        <input type="number" id="efLuminaria" placeholder="0.70" value="0.70" step="0.05" min="0.1" max="1">
      </div>
      <p style="font-size:0.78rem;color:var(--text-muted);margin-bottom:0.8rem;">üí° L√¢mpadas comuns: LED 9W ‚âà 800 lm | LED 12W ‚âà 1100 lm | LED 15W ‚âà 1500 lm | Fluorescente 32W ‚âà 2400 lm</p>
      <button class="btn" onclick="calcularIluminacao()">üí° Calcular</button>
      <button class="btn btn-yellow" onclick="gerarPDFCalc('Ilumina√ß√£o')">üìÑ PDF</button>
      <div id="resultIluminacao"></div>
    </div>
  </div>

  <!-- ========== CALC: CURTO-CIRCUITO ========== -->
  <div id="calcCurtoCircuito" class="screen">
    <div class="screen-title"><div class="dot"></div>Corrente de Curto-Circuito</div>
    <div class="calc-card">
      <h3>‚ö° C√°lculo de Corrente de Curto-Circuito</h3>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;">
        <div class="form-group">
          <label>Tens√£o do sistema (V):</label>
          <input type="number" id="tensaoCC" placeholder="Ex: 220" value="220">
        </div>
        <div class="form-group">
          <label>Pot√™ncia do transformador (kVA):</label>
          <input type="number" id="potTrafo" placeholder="Ex: 75">
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;">
        <div class="form-group">
          <label>Imped√¢ncia do trafo (% ‚Äî padr√£o 4%):</label>
          <input type="number" id="impedTrafo" placeholder="4" value="4" step="0.1">
        </div>
        <div class="form-group">
          <label>Tipo de curto:</label>
          <select id="tipoCC">
            <option value="trifasico">Trif√°sico (3œÜ ‚Äî mais severo)</option>
            <option value="bifasico">Bif√°sico (2œÜ)</option>
            <option value="monofasico">Monof√°sico (1œÜ ‚Äî fase/neutro)</option>
          </select>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;">
        <div class="form-group">
          <label>Se√ß√£o do cabo (mm¬≤):</label>
          <input type="number" id="secCaboCC" placeholder="Ex: 10">
        </div>
        <div class="form-group">
          <label>Comprimento do cabo (m):</label>
          <input type="number" id="distCaboCC" placeholder="Ex: 50">
        </div>
      </div>
      <button class="btn" onclick="calcularCurtoCircuito()">‚ö° Calcular</button>
      <button class="btn btn-yellow" onclick="gerarPDFCalc('Curto-Circuito')">üìÑ PDF</button>
      <div id="resultCurtoCircuito"></div>
    </div>
  </div>

  <!-- ========== CALC: FATOR DE DEMANDA ========== -->
  <div id="calcFatorDemanda" class="screen">
    <div class="screen-title"><div class="dot"></div>Fator de Demanda</div>
    <div class="calc-card">
      <h3>üìä Calculadora de Fator de Demanda</h3>
      <div class="form-group">
        <label>Tens√£o do sistema (V):</label>
        <input type="number" id="tensaoFD" placeholder="220" value="220">
      </div>
      <div id="cargasFD">
        <div class="carga-fd-row consumo-item-row">
          <div class="form-group"><label>Carga</label><input type="text" placeholder="Ex: Ar-cond. 9000 BTU"></div>
          <div class="form-group"><label>Pot√™ncia (W)</label><input type="number" placeholder="Ex: 900"></div>
          <div class="form-group"><label>Qtd</label><input type="number" placeholder="1" value="1" min="1"></div>
          <div class="form-group"><label>FD (%)</label><input type="number" placeholder="75" value="75" min="1" max="100"></div>
        </div>
      </div>
      <p style="font-size:0.78rem;color:var(--text-muted);margin-top:0.5rem;">FD t√≠pico: Ilumina√ß√£o 75% | Tomadas 50% | Motores 65% | AR cond. 80%</p>
      <button class="btn" onclick="adicionarCargaFD()">‚ûï Adicionar Carga</button>
      <button class="btn btn-yellow" onclick="calcularFatorDemanda()">üìä Calcular Demanda</button>
      <div id="resultFatorDemanda"></div>
    </div>
  </div>

  <!-- ========== TABELAS HOME ========== -->
  <div id="tabelasHome" class="screen">
    <div class="screen-title"><div class="dot"></div>Tabelas T√©cnicas</div>
    <div class="sub-grid">
      <div class="sub-tile" onclick="openScreen('tabelaCondutores','Tabela ‚Äî Condutores')">
        <div class="s-icon">üîß</div>
        <div class="s-text"><strong>Condutores</strong><span>Bitolas e specs</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('tabelaDisjuntores','Tabela ‚Äî Disjuntores')">
        <div class="s-icon">üîå</div>
        <div class="s-text"><strong>Disjuntores</strong><span>Amperagem</span></div>
      </div>
      <div class="sub-tile" onclick="openScreen('tabelaCorrentes','Tabela ‚Äî Capacidade')">
        <div class="s-icon">üì°</div>
        <div class="s-text"><strong>Cap. Corrente</strong><span>B1, B2, C</span></div>
      </div>
    </div>
  </div>

  <!-- ========== TABELA CONDUTORES ========== -->
  <div id="tabelaCondutores" class="screen">
    <div class="screen-title"><div class="dot"></div>Condutores</div>
    <div class="calc-card">
      <h3>üîß Tabela de Condutores</h3>
      <button class="btn btn-yellow" onclick="gerarPDFTabela('Condutores')">üìÑ Gerar PDF</button>
      <div class="table-responsive">
        <table>
          <thead><tr><th>Se√ß√£o (mm¬≤)</th><th>Di√¢metro (mm)</th><th>Peso (kg/km)</th><th>Resist√™ncia (Œ©/km)</th></tr></thead>
          <tbody>
            <tr><td>1,5</td><td>1,38</td><td>13,3</td><td>12,1</td></tr>
            <tr><td>2,5</td><td>1,78</td><td>22,2</td><td>7,41</td></tr>
            <tr><td>4</td><td>2,25</td><td>35,5</td><td>4,61</td></tr>
            <tr><td>6</td><td>2,76</td><td>53,3</td><td>3,08</td></tr>
            <tr><td>10</td><td>3,57</td><td>88,8</td><td>1,83</td></tr>
            <tr><td>16</td><td>4,51</td><td>142</td><td>1,15</td></tr>
            <tr><td>25</td><td>5,64</td><td>222</td><td>0,727</td></tr>
            <tr><td>35</td><td>6,68</td><td>311</td><td>0,524</td></tr>
            <tr><td>50</td><td>7,98</td><td>444</td><td>0,387</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ========== TABELA DISJUNTORES ========== -->
  <div id="tabelaDisjuntores" class="screen">
    <div class="screen-title"><div class="dot"></div>Disjuntores</div>
    <div class="calc-card">
      <h3>üîå Tabela de Disjuntores</h3>
      <button class="btn btn-yellow" onclick="gerarPDFTabela('Disjuntores')">üìÑ Gerar PDF</button>
      <div class="table-responsive">
        <table>
          <thead><tr><th>Corrente (A)</th><th>Condutor M√≠n. (mm¬≤)</th><th>Pot√™ncia 127V (W)</th><th>Pot√™ncia 220V (W)</th></tr></thead>
          <tbody>
            <tr><td>10</td><td>1,5</td><td>1.270</td><td>2.200</td></tr>
            <tr><td>16</td><td>2,5</td><td>2.032</td><td>3.520</td></tr>
            <tr><td>20</td><td>4</td><td>2.540</td><td>4.400</td></tr>
            <tr><td>25</td><td>4</td><td>3.175</td><td>5.500</td></tr>
            <tr><td>32</td><td>6</td><td>4.064</td><td>7.040</td></tr>
            <tr><td>40</td><td>10</td><td>5.080</td><td>8.800</td></tr>
            <tr><td>50</td><td>10</td><td>6.350</td><td>11.000</td></tr>
            <tr><td>63</td><td>16</td><td>8.001</td><td>13.860</td></tr>
            <tr><td>70</td><td>25</td><td>8.890</td><td>15.400</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ========== TABELA CAPACIDADE ========== -->
  <div id="tabelaCorrentes" class="screen">
    <div class="screen-title"><div class="dot"></div>Capacidade de Corrente</div>
    <div class="calc-card">
      <h3>‚ö° Capacidade de Corrente (ABNT NBR 5410)</h3>
      <button class="btn btn-yellow" onclick="gerarPDFTabela('Capacidade de Corrente')">üìÑ Gerar PDF</button>
      <div class="table-responsive">
        <table>
          <thead><tr><th>Se√ß√£o (mm¬≤)</th><th>M√©todo B1 (A)</th><th>M√©todo B2 (A)</th><th>M√©todo C (A)</th></tr></thead>
          <tbody>
            <tr><td>1,5</td><td>15,5</td><td>17,5</td><td>19,5</td></tr>
            <tr><td>2,5</td><td>21</td><td>24</td><td>27</td></tr>
            <tr><td>4</td><td>28</td><td>32</td><td>36</td></tr>
            <tr><td>6</td><td>36</td><td>41</td><td>46</td></tr>
            <tr><td>10</td><td>50</td><td>57</td><td>63</td></tr>
            <tr><td>16</td><td>68</td><td>76</td><td>85</td></tr>
            <tr><td>25</td><td>89</td><td>101</td><td>112</td></tr>
            <tr><td>35</td><td>110</td><td>125</td><td>138</td></tr>
            <tr><td>50</td><td>134</td><td>151</td><td>168</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ========== INSTALA√á√ïES ========== -->
  <div id="instalacoes" class="screen">
    <div class="screen-title"><div class="dot"></div>Instala√ß√µes El√©tricas</div>

    <div class="install-item" id="inst1">
      <div class="install-header" onclick="toggleInstall('inst1')">
        <h4>üîå Tomadas e Interruptores</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <h5>Altura padr√£o ABNT NBR 5410:</h5>
        <ul>
          <li>Tomadas de uso geral: <strong>0,30 m</strong> do piso (residencial)</li>
          <li>Tomadas de uso geral: <strong>1,20 m</strong> do piso (para acessibilidade)</li>
          <li>Interruptores: <strong>1,00 m</strong> do piso acabado</li>
          <li>Tomadas em cozinhas e banheiros: <strong>1,20 m</strong></li>
        </ul>
        <h5>Circuitos dedicados:</h5>
        <ul>
          <li>Chuveiro el√©trico: circuito exclusivo (6,0 mm¬≤)</li>
          <li>Ar-condicionado ‚â• 1,5 TR: circuito exclusivo</li>
          <li>Forno el√©trico / micro-ondas: circuito exclusivo</li>
        </ul>
      </div>
    </div>

    <div class="install-item" id="inst2">
      <div class="install-header" onclick="toggleInstall('inst2')">
        <h4>üè† Quadro de Distribui√ß√£o</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <p>O quadro de distribui√ß√£o (QD) deve ser instalado em local de f√°cil acesso, na entrada da edifica√ß√£o.</p>
        <h5>Componentes essenciais:</h5>
        <ul>
          <li>Disjuntor geral (DR geral recomendado)</li>
          <li>Disjuntores individuais por circuito</li>
          <li>DR (diferencial-residual) para banheiros e cozinha</li>
          <li>Barramento de neutro e terra</li>
        </ul>
        <h5>Dist√¢ncias m√≠nimas:</h5>
        <ul>
          <li>Altura da parte inferior: m√≠nimo <strong>1,20 m</strong> do piso</li>
          <li>Parte superior: m√°ximo <strong>2,00 m</strong></li>
        </ul>
      </div>
    </div>

    <div class="install-item" id="inst3">
      <div class="install-header" onclick="toggleInstall('inst3')">
        <h4>‚ö° Aterramento (SPDA)</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <p>O sistema de aterramento √© fundamental para a seguran√ßa el√©trica da instala√ß√£o.</p>
        <h5>Tipos de haste de aterramento:</h5>
        <ul>
          <li>Haste de a√ßo cobreado: 5/8" √ó 2,4 m</li>
          <li>Resist√™ncia m√°xima: <strong>‚â§ 10 Œ©</strong> (residencial)</li>
          <li>Resist√™ncia m√°xima: <strong>‚â§ 5 Œ©</strong> (industrial)</li>
        </ul>
        <h5>Condutor de prote√ß√£o (PE):</h5>
        <ul>
          <li>Circuito ‚â§ 16 mm¬≤: condutor PE = se√ß√£o do fase</li>
          <li>Circuito > 16 mm¬≤: condutor PE ‚â• 50% da fase (m√≠n. 16 mm¬≤)</li>
        </ul>
      </div>
    </div>

    <div class="install-item" id="inst4">
      <div class="install-header" onclick="toggleInstall('inst4')">
        <h4>üí° Ilumina√ß√£o</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <h5>N√≠veis de iluminamento (ABNT NBR 5413):</h5>
        <ul>
          <li>Quarto / Dormit√≥rio: <strong>100 ‚Äì 300 lux</strong></li>
          <li>Sala de estar: <strong>100 ‚Äì 300 lux</strong></li>
          <li>Cozinha: <strong>200 ‚Äì 500 lux</strong></li>
          <li>Escrit√≥rio: <strong>500 ‚Äì 750 lux</strong></li>
          <li>Corredor / Circula√ß√£o: <strong>100 ‚Äì 150 lux</strong></li>
        </ul>
        <h5>Dica de circuito:</h5>
        <ul>
          <li>M√°ximo 600 W por circuito de ilumina√ß√£o</li>
          <li>Condutor m√≠nimo: 1,5 mm¬≤ para ilumina√ß√£o</li>
        </ul>
      </div>
    </div>

    <div class="install-item" id="inst5">
      <div class="install-header" onclick="toggleInstall('inst5')">
        <h4>üöø Banheiros e √Åreas Molhadas</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <p>Zonas de prote√ß√£o para instala√ß√µes em banheiros (ABNT NBR 5410 / IEC 60364-7-701):</p>
        <ul>
          <li><strong>Zona 0:</strong> dentro do box/banheira ‚Äî somente equipamentos SELV 12 V</li>
          <li><strong>Zona 1:</strong> at√© 0,60 m acima do box ‚Äî m√≠n. IPX4</li>
          <li><strong>Zona 2:</strong> at√© 2,40 m altura e 0,60 m lateral ‚Äî m√≠n. IPX4</li>
        </ul>
        <h5>Obrigat√≥rio:</h5>
        <ul>
          <li>Interruptor diferencial-residual (DR) ‚â§ 30 mA</li>
          <li>Liga√ß√£o equipotencial em tubula√ß√µes met√°licas</li>
        </ul>
      </div>
    </div>

    <div class="install-item" id="inst6">
      <div class="install-header" onclick="toggleInstall('inst6')">
        <h4>üîã Instala√ß√£o de No-Break / Estabilizador</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <h5>Procedimento:</h5>
        <ul>
          <li>Verificar pot√™ncia total dos equipamentos (VA ou W)</li>
          <li>Escolher no-break com autonomia m√≠nima de 20 min</li>
          <li>Instalar em local ventilado, longe de umidade</li>
          <li>Utilizar tomadas aterradas (3 pinos)</li>
          <li>Aterramento obrigat√≥rio para prote√ß√£o contra surtos</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- ========== CONSUMO ========== -->
  <div id="consumo" class="screen">
    <div class="screen-title"><div class="dot"></div>Consumo de Energia</div>
    <div class="calc-card">
      <h3>‚ö° Calculadora de Consumo</h3>
      <div id="consumoItens">
        <div class="consumo-item-row" id="consumoRow0">
          <div class="form-group"><label>Aparelho</label><input type="text" placeholder="Ex: Geladeira"></div>
          <div class="form-group"><label>Pot√™ncia (W)</label><input type="number" placeholder="Ex: 300"></div>
          <div class="form-group"><label>Horas/dia</label><input type="number" placeholder="Ex: 8" step="0.5"></div>
        </div>
      </div>
      <button class="btn" style="margin-top:0.5rem;" onclick="addConsumoRow()">‚ûï Adicionar aparelho</button>
      <button class="btn btn-yellow" onclick="calcularConsumo()">‚ö° Calcular</button>
      <div id="resultConsumo"></div>
    </div>

    <div class="calc-card">
      <h3>üí° Tabela de refer√™ncia de pot√™ncias</h3>
      <div class="table-responsive">
        <table>
          <thead><tr><th>Aparelho</th><th>Pot√™ncia T√≠pica (W)</th><th>Uso m√©dio (h/dia)</th></tr></thead>
          <tbody>
            <tr><td>L√¢mpada LED</td><td>9 ‚Äì 15</td><td>5</td></tr>
            <tr><td>TV 50"</td><td>100 ‚Äì 130</td><td>5</td></tr>
            <tr><td>Geladeira Duplex</td><td>300 ‚Äì 400</td><td>24</td></tr>
            <tr><td>Ar-Condicionado 9000 BTU</td><td>900</td><td>8</td></tr>
            <tr><td>Ar-Condicionado 12000 BTU</td><td>1.200</td><td>8</td></tr>
            <tr><td>Chuveiro El√©trico</td><td>5.500 ‚Äì 7.500</td><td>0,5</td></tr>
            <tr><td>Forno El√©trico</td><td>1.200 ‚Äì 2.000</td><td>1</td></tr>
            <tr><td>Micro-ondas</td><td>800 ‚Äì 1.200</td><td>0,5</td></tr>
            <tr><td>M√°quina de lavar</td><td>1.000 ‚Äì 1.500</td><td>1</td></tr>
            <tr><td>Computador Desktop</td><td>200 ‚Äì 400</td><td>8</td></tr>
            <tr><td>Notebook</td><td>45 ‚Äì 90</td><td>8</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ========== OR√áAMENTOS ========== -->
  <div id="orcamentos" class="screen">
    <div class="screen-title"><div class="dot"></div>Or√ßamentos</div>
    <div class="calc-card">
      <h3>üíº Dados do Cliente</h3>
      <div class="form-group"><label>Nome do Cliente:</label><input type="text" id="nomeCliente" placeholder="Ex: Jo√£o Silva"></div>
      <div class="form-group"><label>Telefone:</label><input type="text" id="telefoneCliente" placeholder="Ex: (11) 99999-9999"></div>
      <div class="form-group"><label>Endere√ßo:</label><input type="text" id="enderecoCliente" placeholder="Ex: Rua das Flores, 123"></div>
    </div>
    <div class="calc-card">
      <h3>üõ†Ô∏è Adicionar Item</h3>
      <div class="form-group"><label>Descri√ß√£o:</label><input type="text" id="itemDescricao" placeholder="Ex: Instala√ß√£o de tomada 220V"></div>
      <div class="form-group"><label>Quantidade:</label><input type="number" id="itemQuantidade" placeholder="Ex: 5" value="1"></div>
      <div class="form-group"><label>Valor Unit√°rio (R$):</label><input type="number" id="itemValor" placeholder="Ex: 150.00" step="0.01"></div>
      <button class="btn" onclick="adicionarItem()">‚ûï Adicionar Item</button>
    </div>
    <div class="calc-card">
      <h3>üìã Itens do Or√ßamento</h3>
      <div id="listaItens"><p style="color:var(--text-muted);">Nenhum item adicionado</p></div>
      <div class="total-box" id="totalOrcamento">Total: R$ 0,00</div>
      <button class="btn btn-yellow" style="margin-top:0.8rem;" onclick="gerarPDFOrcamento()">üìÑ Gerar PDF do Or√ßamento</button>
    </div>
  </div>

  <!-- ========== NORMAS ========== -->
  <div id="normas" class="screen">
    <div class="screen-title"><div class="dot"></div>Normas T√©cnicas</div>
    <div class="install-item" id="norm1">
      <div class="install-header" onclick="toggleInstall('norm1')">
        <h4>üìã ABNT NBR 5410 ‚Äî Instala√ß√µes de baixa tens√£o</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <p>A norma ABNT NBR 5410 √© a principal norma brasileira para instala√ß√µes el√©tricas de baixa tens√£o em edifica√ß√µes.</p>
        <h5>Principais requisitos:</h5>
        <ul>
          <li>Dimensionamento correto de condutores e prote√ß√µes</li>
          <li>Obrigatoriedade de aterramento em toda a instala√ß√£o</li>
          <li>Uso de DR em banheiros, cozinhas, lavanderia e √°rea externa</li>
          <li>Tomadas com prote√ß√£o (shutter) em locais acess√≠veis a crian√ßas</li>
          <li>Separa√ß√£o de circuitos de ilumina√ß√£o e tomadas</li>
        </ul>
      </div>
    </div>
    <div class="install-item" id="norm2">
      <div class="install-header" onclick="toggleInstall('norm2')">
        <h4>‚ö° ABNT NBR 5419 ‚Äî SPDA (Para-raios)</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <p>Norma para Sistemas de Prote√ß√£o contra Descargas Atmosf√©ricas (para-raios).</p>
        <h5>N√≠veis de prote√ß√£o (NP):</h5>
        <ul>
          <li>NP I ‚Äî Alta prioridade (hospitais, escolas)</li>
          <li>NP II ‚Äî Prioridade m√©dia-alta (ind√∫strias)</li>
          <li>NP III ‚Äî Prioridade m√©dia (resid√™ncias)</li>
          <li>NP IV ‚Äî Prioridade padr√£o</li>
        </ul>
      </div>
    </div>
    <div class="install-item" id="norm3">
      <div class="install-header" onclick="toggleInstall('norm3')">
        <h4>üîå ABNT NBR 14136 ‚Äî Tomadas</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <p>Define o padr√£o brasileiro de tomadas el√©tricas (padr√£o NBR, substituindo o antigo padr√£o).</p>
        <ul>
          <li>Tomada 10 A ‚Äî pinos de 4 mm (aparelhos dom√©sticos)</li>
          <li>Tomada 20 A ‚Äî pinos de 4,8 mm (equipamentos pesados)</li>
          <li>Pino terra obrigat√≥rio em todas as tomadas</li>
          <li>Shutter (protetor de pinos) obrigat√≥rio desde 2011</li>
        </ul>
      </div>
    </div>
    <div class="install-item" id="norm4">
      <div class="install-header" onclick="toggleInstall('norm4')">
        <h4>üè≠ NR-10 ‚Äî Seguran√ßa em Eletricidade</h4><span class="install-chevron">‚ñº</span>
      </div>
      <div class="install-body">
        <p>Norma Regulamentadora do MTE para seguran√ßa em instala√ß√µes e servi√ßos el√©tricos.</p>
        <h5>Requisitos principais:</h5>
        <ul>
          <li>Treinamento obrigat√≥rio para todo trabalhador com risco el√©trico</li>
          <li>NR-10 B√°sico: 40 horas ‚Äî para n√£o eletricistas</li>
          <li>NR-10 SEP: 40 horas adicionais ‚Äî para eletricistas em SEP</li>
          <li>Uso obrigat√≥rio de EPI e EPC</li>
          <li>Prontu√°rio de instala√ß√µes el√©tricas atualizado</li>
        </ul>
      </div>
    </div>
  </div>

</div><!-- /container -->

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

<script>
/* ======================== STARS ======================== */
(function(){
  const c = document.getElementById('stars-canvas');
  const ctx = c.getContext('2d');
  let W, H, stars = [];
  function resize(){ W = c.width = window.innerWidth; H = c.height = window.innerHeight; }
  function mkStar(){ return { x:Math.random()*W, y:Math.random()*H, r:Math.random()*1.2+0.2, a:Math.random(), da:(Math.random()-0.5)*0.005 }; }
  function init(){ resize(); stars=[]; for(let i=0;i<120;i++) stars.push(mkStar()); }
  function draw(){
    ctx.clearRect(0,0,W,H);
    stars.forEach(s=>{ s.a+=s.da; if(s.a<0)s.da=Math.abs(s.da); if(s.a>1)s.da=-Math.abs(s.da); ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fillStyle=`rgba(255,255,255,${s.a})`; ctx.fill(); });
    requestAnimationFrame(draw);
  }
  window.addEventListener('resize',init);
  init(); draw();
})();

/* ======================== NAVIGATION ======================== */
let screenStack = [];

function openScreen(id, title) {
  // hide all
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  screenStack.push(id);
  document.getElementById('headerBack').style.display = 'block';
  document.getElementById('headerSubtitle').textContent = title;
  window.scrollTo({top:0,behavior:'smooth'});
}

function goHome() {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('homeScreen').classList.add('active');
  screenStack = [];
  document.getElementById('headerBack').style.display = 'none';
  document.getElementById('headerSubtitle').textContent = 'Calculadoras, Tabelas e Instala√ß√µes';
  window.scrollTo({top:0,behavior:'smooth'});
}

/* ======================== TRIAL ======================== */
const TRIAL_KEY = 'eletricapro_trial';
function initTrial(){
  if(!localStorage.getItem(TRIAL_KEY)){
    localStorage.setItem(TRIAL_KEY, JSON.stringify({startDate:new Date().toISOString(), isPro:false}));
  }
  updateTrialBanner();
}
function updateTrialBanner(){
  const d = JSON.parse(localStorage.getItem(TRIAL_KEY));
  const days = Math.floor((new Date()-new Date(d.startDate))/(864e5));
  const left = 7-days;
  const banner = document.getElementById('trialBanner');
  if(d.isPro){ banner.innerHTML='üåü Vers√£o PRO Ativada'; banner.style.background='linear-gradient(135deg,#2e7d32,#43a047)'; }
  else if(left>0){ banner.innerHTML=`üéÅ Per√≠odo de teste: <span id="daysLeft">${left}</span> dias restantes`; }
  else { banner.innerHTML='‚ö†Ô∏è Teste expirado ‚Äî <a href="#" onclick="ativarPro()" style="color:white;text-decoration:underline;">Ativar PRO</a>'; banner.style.background='linear-gradient(135deg,#b71c1c,#e53935)'; }
}
function checkTrialExpired(){
  const d = JSON.parse(localStorage.getItem(TRIAL_KEY));
  if(d.isPro) return false;
  const days=Math.floor((new Date()-new Date(d.startDate))/(864e5));
  if(days>=7){ alert('‚ö†Ô∏è Per√≠odo de teste expirado! Ative a vers√£o PRO.'); return true; }
  return false;
}
function ativarPro(){
  if(confirm('üåü Deseja ativar a vers√£o PRO?\n\n‚úÖ Acesso ilimitado\n‚úÖ Sem an√∫ncios\n‚úÖ Suporte priorit√°rio')){
    const d=JSON.parse(localStorage.getItem(TRIAL_KEY)); d.isPro=true;
    localStorage.setItem(TRIAL_KEY,JSON.stringify(d)); updateTrialBanner();
    alert('üéâ Vers√£o PRO ativada com sucesso!');
  }
}

/* ======================== CALCULADORAS ======================== */
let lastCalcResults = {};

function showResult(divId, html){ document.getElementById(divId).innerHTML=html; }

function resultBox(title, items){
  return `<div class="result-box"><h4>üìä ${title}</h4>${items.map(([l,v])=>`<div class="result-item"><span>${l}</span><strong>${v}</strong></div>`).join('')}</div>`;
}

function calcularLeiOhm(){
  if(checkTrialExpired()) return;
  const V=parseFloat(document.getElementById('tensaoOhm').value)||0;
  const I=parseFloat(document.getElementById('correnteOhm').value)||0;
  const R=parseFloat(document.getElementById('resistenciaOhm').value)||0;
  let v=V,i=I,r=R;
  if(V&&I&&!R) r=(V/I).toFixed(3);
  else if(V&&R&&!I) i=(V/R).toFixed(3);
  else if(I&&R&&!V) v=(I*R).toFixed(3);
  else { alert('Preencha exatamente 2 dos 3 campos!'); return; }
  lastCalcResults.leiOhm={v,i,r};
  showResult('resultLeiOhm', resultBox('Lei de Ohm',[['Tens√£o (V)',`${v} V`],['Corrente (I)',`${i} A`],['Resist√™ncia (R)',`${r} Œ©`]]));
}

function calcularPotencia(){
  if(checkTrialExpired()) return;
  const V=parseFloat(document.getElementById('tensaoPot').value);
  const I=parseFloat(document.getElementById('correntePot').value);
  const fp=parseFloat(document.getElementById('fatorPot').value);
  const tipo=document.getElementById('tipoCircuito').value;
  if(!V||!I||!fp){ alert('Preencha todos os campos!'); return; }
  let S = tipo==='monofasico' ? V*I : Math.sqrt(3)*V*I;
  let P = S*fp, Q = Math.sqrt(S*S-P*P);
  lastCalcResults.potencia={tipo,V,I,fp,P:P.toFixed(2),S:S.toFixed(2),Q:Q.toFixed(2)};
  showResult('resultPotencia', resultBox(`Pot√™ncia ‚Äî ${tipo==='monofasico'?'Monof√°sico':'Trif√°sico'}`,[['Pot√™ncia Ativa (P)',`${P.toFixed(2)} W`],['Pot√™ncia Aparente (S)',`${S.toFixed(2)} VA`],['Pot√™ncia Reativa (Q)',`${Q.toFixed(2)} VAr`],['Fator de Pot√™ncia',fp]]));
}

function calcularQuedaTensao(){
  if(checkTrialExpired()) return;
  const I=parseFloat(document.getElementById('correnteQueda').value);
  const L=parseFloat(document.getElementById('distanciaQueda').value);
  const s=parseFloat(document.getElementById('secaoQueda').value);
  const V=parseFloat(document.getElementById('tensaoQueda').value);
  if(!I||!L||!s||!V){ alert('Preencha todos os campos!'); return; }
  const ro=0.0172, R=(ro*2*L)/s, dV=I*R, pct=(dV/V)*100;
  const ok=pct<=4;
  lastCalcResults.quedaTensao={I,L,s,V,dV:dV.toFixed(2),pct:pct.toFixed(2),ok};
  showResult('resultQuedaTensao', resultBox('Queda de Tens√£o',[['Queda de Tens√£o',`${dV.toFixed(2)} V`],['Percentual',`${pct.toFixed(2)}%`],['Status (limite 4%)',ok?'‚úÖ Dentro do limite':'‚ùå Acima do limite']]));
}

function dimensionarCondutor(){
  if(checkTrialExpired()) return;
  const P=parseFloat(document.getElementById('potenciaCondutor').value);
  const V=parseFloat(document.getElementById('tensaoCondutor').value);
  const L=parseFloat(document.getElementById('distanciaCondutor').value);
  const tipo=document.getElementById('tipoInstalacao').value;
  if(!P||!V||!L){ alert('Preencha todos os campos!'); return; }
  const I=P/V;
  const cap={B1:[{s:1.5,c:15.5},{s:2.5,c:21},{s:4,c:28},{s:6,c:36},{s:10,c:50},{s:16,c:68},{s:25,c:89},{s:35,c:110},{s:50,c:134}],
             B2:[{s:1.5,c:17.5},{s:2.5,c:24},{s:4,c:32},{s:6,c:41},{s:10,c:57},{s:16,c:76},{s:25,c:101},{s:35,c:125},{s:50,c:151}],
             C: [{s:1.5,c:19.5},{s:2.5,c:27},{s:4,c:36},{s:6,c:46},{s:10,c:63},{s:16,c:85},{s:25,c:112},{s:35,c:138},{s:50,c:168}]};
  let sec=50;
  for(let x of cap[tipo]) if(x.c>=I*1.25){ sec=x.s; break; }
  const ro=0.0172, dV=I*(ro*2*L)/sec, pct=(dV/V)*100;
  if(pct>4){ const sMin=(ro*2*L*I)/(V*0.04); [1.5,2.5,4,6,10,16,25,35,50,70,95].forEach(s=>{ if(s>=sMin&&s>sec) sec=s; }); }
  const disj=[10,16,20,25,32,40,50,63,70].find(d=>d>=I)||63;
  lastCalcResults.condutor={P,V,I:I.toFixed(2),sec,disj,pct:pct.toFixed(2)};
  showResult('resultCondutor', resultBox('Dimensionamento',[['Corrente calculada',`${I.toFixed(2)} A`],['Se√ß√£o recomendada',`${sec} mm¬≤`],['Disjuntor recomendado',`${disj} A`],['Queda de tens√£o',`${pct.toFixed(2)}%`]]));
}

/* ======================== CONSUMO ======================== */
let consumoRowCount = 1;
function addConsumoRow(){
  const container = document.getElementById('consumoItens');
  const div = document.createElement('div');
  div.className = 'consumo-item-row'; div.id='consumoRow'+consumoRowCount;
  div.innerHTML=`
    <div class="form-group"><label>Aparelho</label><input type="text" placeholder="Ex: TV"></div>
    <div class="form-group"><label>Pot√™ncia (W)</label><input type="number" placeholder="Ex: 100"></div>
    <div class="form-group"><label>Horas/dia</label><input type="number" placeholder="Ex: 5" step="0.5"></div>
    <div style="padding-bottom:0.9rem;display:flex;align-items:flex-end;"><button class="btn btn-red" onclick="this.closest('.consumo-item-row').remove()">üóëÔ∏è</button></div>`;
  container.appendChild(div); consumoRowCount++;
}
function calcularConsumo(){
  if(checkTrialExpired()) return;
  const rows = document.querySelectorAll('.consumo-item-row');
  let totalW=0, items=[];
  rows.forEach(row=>{
    const inputs=row.querySelectorAll('input');
    const nome=inputs[0].value||'Aparelho', W=parseFloat(inputs[1].value)||0, h=parseFloat(inputs[2].value)||0;
    if(W&&h){ const kwh=(W*h*30)/1000; totalW+=kwh; items.push({nome,W,h,kwh:kwh.toFixed(2)}); }
  });
  if(!items.length){ alert('Preencha pelo menos um aparelho!'); return; }
  const custo=(totalW*0.75).toFixed(2); // ~R$0,75/kWh
  let html=`<div class="consumo-result-summary"><h4>‚ö° Consumo Mensal Estimado</h4><div class="consumo-big">${totalW.toFixed(1)} <span>kWh/m√™s</span></div>`;
  html+=`<div class="result-item"><span>üí∏ Custo estimado (R$ 0,75/kWh)</span><strong>R$ ${custo}</strong></div>`;
  items.forEach(it=>{ html+=`<div class="result-item"><span>${it.nome} (${it.W}W √ó ${it.h}h/dia)</span><strong>${it.kwh} kWh</strong></div>`; });
  html+=`</div>`;
  document.getElementById('resultConsumo').innerHTML=html;
}


  
/* ======================== OR√áAMENTOS ======================== */
let itensOrcamento=[];
function adicionarItem(){
  if(checkTrialExpired()) return;
  const d=document.getElementById('itemDescricao').value;
  const q=parseFloat(document.getElementById('itemQuantidade').value);
  const v=parseFloat(document.getElementById('itemValor').value);
  if(!d||!q||!v){ alert('Preencha todos os campos!'); return; }
  itensOrcamento.push({id:Date.now(),d,q,v,total:q*v});
  renderItens();
  document.getElementById('itemDescricao').value='';
  document.getElementById('itemQuantidade').value='1';
  document.getElementById('itemValor').value='';
}
function removerItem(id){ itensOrcamento=itensOrcamento.filter(i=>i.id!==id); renderItens(); }
function renderItens(){
  const lista=document.getElementById('listaItens');
  if(!itensOrcamento.length){ lista.innerHTML='<p style="color:var(--text-muted);">Nenhum item adicionado</p>'; }
  else { lista.innerHTML=itensOrcamento.map(i=>`<div class="orcamento-item"><div><strong>${i.d}</strong><br><small>${i.q} √ó R$ ${i.v.toFixed(2)} = R$ ${i.total.toFixed(2)}</small></div><button class="btn btn-red" onclick="removerItem(${i.id})">üóëÔ∏è</button></div>`).join(''); }
  document.getElementById('totalOrcamento').textContent=`Total: R$ ${itensOrcamento.reduce((s,i)=>s+i.total,0).toFixed(2)}`;
}

/* ======================== INSTALA√á√ïES TOGGLE ======================== */
function toggleInstall(id){
  const el=document.getElementById(id);
  el.classList.toggle('open');
}

/* ======================== PDF ======================== */
function pdfHeader(doc, subtitle){
  doc.setFillColor(10,22,40); doc.rect(0,0,210,45,'F');
  doc.setFillColor(21,101,192); doc.rect(0,40,210,5,'F');
  doc.setTextColor(255,214,0); doc.setFontSize(22); doc.setFont(undefined,'bold');
  doc.text('‚ö° El√©trica Pro',20,22);
  doc.setTextColor(255,255,255); doc.setFontSize(11); doc.setFont(undefined,'normal');
  doc.text(subtitle,20,34);
  doc.setTextColor(0,0,0);
}
function pdfFooter(doc){
  doc.setFontSize(8); doc.setTextColor(128,128,128);
  doc.text(`Gerado em ${new Date().toLocaleString('pt-BR')} ‚Äî El√©trica Pro`,105,285,{align:'center'});
}

function gerarPDFCalc(tipo){
  if(checkTrialExpired()) return;
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF();
  pdfHeader(doc,`Relat√≥rio: ${tipo}`);
  doc.setFontSize(14); doc.setFont(undefined,'bold'); doc.text(`C√°lculo: ${tipo}`,20,58);
  doc.setFontSize(10); doc.setFont(undefined,'normal');
  let y=70;
  const line=(l,v)=>{ doc.text(`${l}: ${v}`,20,y); y+=8; };
  if(tipo==='Lei de Ohm'&&lastCalcResults.leiOhm){
    const r=lastCalcResults.leiOhm;
    line('Tens√£o (V)',r.v+' V'); line('Corrente (I)',r.i+' A'); line('Resist√™ncia (R)',r.r+' Œ©');
  } else if(tipo==='Pot√™ncia'&&lastCalcResults.potencia){
    const r=lastCalcResults.potencia;
    line('Tipo',r.tipo==='monofasico'?'Monof√°sico':'Trif√°sico'); line('Tens√£o',r.V+' V'); line('Corrente',r.I+' A');
    line('Fator de Pot√™ncia',r.fp); line('Pot√™ncia Ativa',r.P+' W'); line('Pot√™ncia Aparente',r.S+' VA'); line('Pot√™ncia Reativa',r.Q+' VAr');
  } else if(tipo==='Queda de Tens√£o'&&lastCalcResults.quedaTensao){
    const r=lastCalcResults.quedaTensao;
    line('Corrente',r.I+' A'); line('Dist√¢ncia',r.L+' m'); line('Se√ß√£o',r.s+' mm¬≤');
    line('Tens√£o',r.V+' V'); line('Queda de Tens√£o',r.dV+' V'); line('Percentual',r.pct+'%');
    line('Status',r.ok?'‚úÖ Dentro do limite':'‚ùå Acima do limite');
  } else if(tipo==='Dimensionamento'&&lastCalcResults.condutor){
    const r=lastCalcResults.condutor;
    line('Pot√™ncia',r.P+' W'); line('Tens√£o',r.V+' V'); line('Corrente calculada',r.I+' A');
    line('Se√ß√£o recomendada',r.sec+' mm¬≤'); line('Disjuntor recomendado',r.disj+' A');
    line('Queda de tens√£o',r.pct+'%');
  }
  pdfFooter(doc);
  doc.save(`calculo_${tipo.replace(/ /g,'_')}_${Date.now()}.pdf`);
}

function gerarPDFTabela(tipo){
  if(checkTrialExpired()) return;
  const {jsPDF}=window.jspdf; const doc=new jsPDF();
  pdfHeader(doc,`Tabela: ${tipo}`);
  doc.setFontSize(14); doc.setFont(undefined,'bold'); doc.text(`Tabela T√©cnica: ${tipo}`,20,58);
  const hs={fillColor:[21,101,192]};
  if(tipo==='Condutores'){
    doc.autoTable({startY:68,head:[['Se√ß√£o (mm¬≤)','Di√¢metro (mm)','Peso (kg/km)','Resist√™ncia (Œ©/km)']],body:[['1,5','1,38','13,3','12,1'],['2,5','1,78','22,2','7,41'],['4','2,25','35,5','4,61'],['6','2,76','53,3','3,08'],['10','3,57','88,8','1,83'],['16','4,51','142','1,15'],['25','5,64','222','0,727'],['35','6,68','311','0,524'],['50','7,98','444','0,387']],headStyles:hs});
  } else if(tipo==='Disjuntores'){
    doc.autoTable({startY:68,head:[['Corrente (A)','Condutor M√≠n. (mm¬≤)','Pot√™ncia 127V (W)','Pot√™ncia 220V (W)']],body:[['10','1,5','1.270','2.200'],['16','2,5','2.032','3.520'],['20','4','2.540','4.400'],['25','4','3.175','5.500'],['32','6','4.064','7.040'],['40','10','5.080','8.800'],['50','10','6.350','11.000'],['63','16','8.001','13.860'],['70','25','8.890','15.400']],headStyles:hs});
  } else {
    doc.autoTable({startY:68,head:[['Se√ß√£o (mm¬≤)','M√©todo B1 (A)','M√©todo B2 (A)','M√©todo C (A)']],body:[['1,5','15,5','17,5','19,5'],['2,5','21','24','27'],['4','28','32','36'],['6','36','41','46'],['10','50','57','63'],['16','68','76','85'],['25','89','101','112'],['35','110','125','138'],['50','134','151','168']],headStyles:hs});
  }
  pdfFooter(doc);
  doc.save(`tabela_${tipo.replace(/ /g,'_')}_${Date.now()}.pdf`);
}

function gerarPDFOrcamento(){
  if(checkTrialExpired()) return;
  const nome=document.getElementById('nomeCliente').value;
  if(!nome||!itensOrcamento.length){ alert('Preencha o nome do cliente e adicione itens!'); return; }
  const {jsPDF}=window.jspdf; const doc=new jsPDF();
  pdfHeader(doc,'Or√ßamento Profissional');
  doc.setFontSize(12); let y=58;
  doc.setFont(undefined,'bold'); doc.text('Dados do Cliente:',20,y); y+=9;
  doc.setFont(undefined,'normal'); doc.setFontSize(10);
  doc.text(`Nome: ${nome}`,20,y); y+=7;
  doc.text(`Telefone: ${document.getElementById('telefoneCliente').value}`,20,y); y+=7;
  doc.text(`Endere√ßo: ${document.getElementById('enderecoCliente').value}`,20,y); y+=7;
  doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`,20,y); y+=4;
  const total=itensOrcamento.reduce((s,i)=>s+i.total,0);
  doc.autoTable({startY:y+6,head:[['Descri√ß√£o','Qtd','Valor Unit.','Valor Total']],body:itensOrcamento.map(i=>[i.d,i.q,`R$ ${i.v.toFixed(2)}`,`R$ ${i.total.toFixed(2)}`]),foot:[['','','TOTAL:',`R$ ${total.toFixed(2)}`]],headStyles:{fillColor:[21,101,192]},footStyles:{fillColor:[30,120,60],fontStyle:'bold',fontSize:12}});
  const fy=doc.lastAutoTable.finalY+14;
  doc.setFontSize(10);
  doc.text('Obs: Validade do or√ßamento: 30 dias | Condi√ß√µes: A combinar',20,fy);
  pdfFooter(doc);
  doc.save(`orcamento_${nome.replace(/ /g,'_')}_${Date.now()}.pdf`);
}

/* ======================== INIT ======================== */
window.addEventListener('load', () => { initTrial(); initTheme(); updateUnidades(); });

/* ======================== NOVAS FUNCIONALIDADES ======================== */
// ===== NOVAS FUNCIONALIDADES - ELETRICOPRO =====

// ===== 1. CALCULADORA DE CONVERS√ÉO =====
const conversaoData = {
  potencia: {
    unidades: ['Watts (W)', 'Quilowatts (kW)', 'Cavalos-Vapor (CV/HP)', 'Megawatts (MW)', 'Milliwatts (mW)'],
    valores:  ['W', 'kW', 'CV', 'MW', 'mW'],
    toW: { W:1, kW:1000, CV:735.499, MW:1e6, mW:0.001 },
    fromW: { W:1, kW:0.001, CV:1/735.499, MW:1e-6, mW:1000 }
  },
  tensao: {
    unidades: ['Volts (V)', 'Quilovolts (kV)', 'Milivolts (mV)', 'Microvolts (¬µV)'],
    valores:  ['V', 'kV', 'mV', '¬µV'],
    toV: { V:1, kV:1000, mV:0.001, '¬µV':0.000001 },
    fromV: { V:1, kV:0.001, mV:1000, '¬µV':1000000 }
  },
  corrente: {
    unidades: ['Amperes (A)', 'Miliamperes (mA)', 'Quiloamperes (kA)', 'Microamperes (¬µA)'],
    valores:  ['A', 'mA', 'kA', '¬µA'],
    toA: { A:1, mA:0.001, kA:1000, '¬µA':0.000001 },
    fromA: { A:1, mA:1000, kA:0.001, '¬µA':1000000 }
  },
  resistencia: {
    unidades: ['Ohms (Œ©)', 'Quiloohms (kŒ©)', 'Megaohms (MŒ©)', 'Miliohms (mŒ©)'],
    valores:  ['Œ©', 'kŒ©', 'MŒ©', 'mŒ©'],
    toOhm: { 'Œ©':1, 'kŒ©':1000, 'MŒ©':1e6, 'mŒ©':0.001 },
    fromOhm: { 'Œ©':1, 'kŒ©':0.001, 'MŒ©':1e-6, 'mŒ©':1000 }
  },
  energia: {
    unidades: ['Quilowatt-hora (kWh)', 'Watt-hora (Wh)', 'Joule (J)', 'Megajoule (MJ)', 'Caloria (kcal)'],
    valores:  ['kWh', 'Wh', 'J', 'MJ', 'kcal'],
    toKwh: { kWh:1, Wh:0.001, J:2.778e-7, MJ:0.2778, kcal:0.001163 },
    fromKwh: { kWh:1, Wh:1000, J:3600000, MJ:3.6, kcal:860 }
  },
  bitola: {
    // AWG to mm¬≤ table
    awgTable: [
      {awg:'4/0', mm2:107.2},  {awg:'3/0', mm2:85.0},   {awg:'2/0', mm2:67.4},
      {awg:'1/0', mm2:53.5},   {awg:'1',   mm2:42.4},   {awg:'2',   mm2:33.6},
      {awg:'3',   mm2:26.7},   {awg:'4',   mm2:21.1},   {awg:'6',   mm2:13.3},
      {awg:'8',   mm2:8.37},   {awg:'10',  mm2:5.26},   {awg:'12',  mm2:3.31},
      {awg:'14',  mm2:2.08},   {awg:'16',  mm2:1.31},   {awg:'18',  mm2:0.823},
      {awg:'20',  mm2:0.519},  {awg:'22',  mm2:0.326},  {awg:'24',  mm2:0.205}
    ]
  }
};

function updateUnidades() {
  const tipo = document.getElementById('tipoConversao').value;
  const sel = document.getElementById('unidadeConversao');
  sel.innerHTML = '';
  if (tipo === 'bitola') {
    ['mm¬≤ ‚Üí AWG', 'AWG ‚Üí mm¬≤'].forEach(u => {
      const opt = document.createElement('option'); opt.value = u; opt.textContent = u; sel.appendChild(opt);
    });
  } else {
    const data = conversaoData[tipo];
    data.unidades.forEach((u, i) => {
      const opt = document.createElement('option'); opt.value = data.valores[i]; opt.textContent = u; sel.appendChild(opt);
    });
  }
}

function calcularConversao() {
  if(checkTrialExpired()) return;
  const tipo = document.getElementById('tipoConversao').value;
  const valor = parseFloat(document.getElementById('valorConversao').value);
  const unidade = document.getElementById('unidadeConversao').value;
  
  if (isNaN(valor) || valor === '') { alert('Digite um valor v√°lido!'); return; }
  
  let html = '<div class="result-box"><h4>üîÑ Resultados da Convers√£o</h4>';
  
  if (tipo === 'bitola') {
    const tbl = conversaoData.bitola.awgTable;
    if (unidade === 'mm¬≤ ‚Üí AWG') {
      const closest = tbl.reduce((prev, curr) => Math.abs(curr.mm2 - valor) < Math.abs(prev.mm2 - valor) ? curr : prev);
      html += `<div class="result-item"><span>Valor inserido</span><strong>${valor} mm¬≤</strong></div>`;
      html += `<div class="result-item"><span>AWG equivalente mais pr√≥ximo</span><strong>AWG ${closest.awg}</strong></div>`;
      html += `<div class="result-item"><span>mm¬≤ exato do AWG ${closest.awg}</span><strong>${closest.mm2} mm¬≤</strong></div>`;
      html += '<div style="margin-top:1rem;font-size:0.82rem;color:var(--text-muted);">üìã Tabela AWG ‚Üî mm¬≤ completa:</div>';
      html += '<div class="table-responsive" style="margin-top:0.5rem;"><table><thead><tr><th>AWG</th><th>mm¬≤</th><th>AWG</th><th>mm¬≤</th></tr></thead><tbody>';
      for (let i=0; i<tbl.length-1; i+=2) {
        html += `<tr><td>${tbl[i].awg}</td><td>${tbl[i].mm2}</td><td>${tbl[i+1]?.awg||''}</td><td>${tbl[i+1]?.mm2||''}</td></tr>`;
      }
      html += '</tbody></table></div>';
    } else {
      const awgStr = prompt('Digite o n√∫mero AWG (ex: 12, 4/0, 1/0):');
      const found = tbl.find(r => r.awg === awgStr?.trim());
      if (!found) { alert('AWG n√£o encontrado. Use: 4/0, 3/0, 2/0, 1/0, 1, 2, 3, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24'); return; }
      html += `<div class="result-item"><span>AWG ${found.awg}</span><strong>${found.mm2} mm¬≤</strong></div>`;
    }
  } else {
    const data = conversaoData[tipo];
    const keys = Object.keys(data.unidades ? {} : {});
    // Convert to base unit first
    let baseKey, baseUnit, toBase, fromBase;
    if (tipo === 'potencia')      { toBase = data.toW;   fromBase = data.fromW;  baseUnit = 'W'; }
    else if (tipo === 'tensao')   { toBase = data.toV;   fromBase = data.fromV;  baseUnit = 'V'; }
    else if (tipo === 'corrente') { toBase = data.toA;   fromBase = data.fromA;  baseUnit = 'A'; }
    else if (tipo === 'resistencia') { toBase = data.toOhm; fromBase = data.fromOhm; baseUnit = 'Œ©'; }
    else if (tipo === 'energia')  { toBase = data.toKwh; fromBase = data.fromKwh; baseUnit = 'kWh'; }
    
    const baseVal = valor * toBase[unidade];
    
    html += `<div class="result-item"><span>Valor original</span><strong>${valor} ${unidade}</strong></div>`;
    html += `<div style="height:0.5rem;"></div>`;
    
    Object.keys(fromBase).forEach(u => {
      if (u !== unidade) {
        const converted = baseVal * fromBase[u];
        let display = converted;
        if (converted >= 1e6) display = converted.toExponential(4);
        else if (converted < 0.0001 && converted !== 0) display = converted.toExponential(4);
        else display = parseFloat(converted.toFixed(6)).toString();
        html += `<div class="result-item"><span>${u}</span><strong>${display} ${u}</strong></div>`;
      }
    });
  }
  
  html += '</div>';
  document.getElementById('resultConversao').innerHTML = html;
}

// ===== 2. CALCULADORA DE ILUMINA√á√ÉO =====
function calcularIluminacao() {
  if(checkTrialExpired()) return;
  
  const area = parseFloat(document.getElementById('areaIlum').value);
  const altura = parseFloat(document.getElementById('alturaIlum').value);
  const planoTrabalho = parseFloat(document.getElementById('planoTrabalho').value) || 0.75;
  const tipoAmbiente = document.getElementById('tipoAmbienteIlum').value;
  const efLuminaria = parseFloat(document.getElementById('efLuminaria').value) || 0.7;
  const fluxoLamp = parseFloat(document.getElementById('fluxoLamp').value);
  
  if (!area || !altura || !fluxoLamp) { alert('Preencha todos os campos obrigat√≥rios!'); return; }
  
  // Ilumin√¢ncias recomendadas (ABNT NBR ISO/CIE 8995-1)
  const iluminancias = {
    sala:       { E: 200, nome: 'Sala de Estar' },
    quarto:     { E: 100, nome: 'Quarto' },
    cozinha:    { E: 300, nome: 'Cozinha' },
    escritorio: { E: 500, nome: 'Escrit√≥rio' },
    banheiro:   { E: 200, nome: 'Banheiro' },
    garagem:    { E: 75,  nome: 'Garagem' },
    corredor:   { E: 100, nome: 'Corredor' },
    externo:    { E: 50,  nome: '√Årea Externa' }
  };
  
  const { E, nome } = iluminancias[tipoAmbiente];
  
  // √çndice do Local (K)
  const larguraEst = Math.sqrt(area * 0.75);
  const comprimentoEst = area / larguraEst;
  const h = altura - planoTrabalho;
  const K = (larguraEst * comprimentoEst) / (h * (larguraEst + comprimentoEst));
  
  // Fator de Utiliza√ß√£o (aproxima√ß√£o baseada em K)
  let fu = 0.5;
  if (K >= 0.6 && K < 1) fu = 0.55;
  else if (K >= 1 && K < 1.5) fu = 0.60;
  else if (K >= 1.5 && K < 2) fu = 0.65;
  else if (K >= 2 && K < 2.5) fu = 0.70;
  else if (K >= 2.5) fu = 0.75;
  
  // Fator de Manuten√ß√£o (deprecia√ß√£o, teto claro)
  const fm = 0.80;
  
  // N√∫mero de l√¢mpadas necess√°rias
  const nLampadas = Math.ceil((E * area) / (fluxoLamp * fu * fm));
  const nLuminarias = Math.ceil(nLampadas / 2); // assumindo 2 l√¢mpadas por lumin√°ria
  const fluxoTotal = nLampadas * fluxoLamp;
  const iluminanciaReal = (fluxoTotal * fu * fm) / area;
  
  const html = `
    <div class="result-box">
      <h4>üí° Resultado ‚Äî ${nome}</h4>
      <div class="result-item"><span>Ilumin√¢ncia recomendada (ABNT)</span><strong>${E} lux</strong></div>
      <div class="result-item"><span>√Årea do ambiente</span><strong>${area} m¬≤</strong></div>
      <div class="result-item"><span>√çndice do local (K)</span><strong>${K.toFixed(2)}</strong></div>
      <div class="result-item"><span>Fator de utiliza√ß√£o (Fu)</span><strong>${fu.toFixed(2)}</strong></div>
      <div class="result-item"><span>Fator de manuten√ß√£o (Fm)</span><strong>${fm}</strong></div>
      <div style="border-top:2px solid var(--blue-glow);margin:0.8rem 0;"></div>
      <div class="result-item"><span>üîÜ N¬∫ de l√¢mpadas necess√°rias</span><strong style="color:var(--yellow);font-size:1.1rem;">${nLampadas} l√¢mpadas</strong></div>
      <div class="result-item"><span>üí° N¬∫ de lumin√°rias (2 l√¢mp/lum.)</span><strong>${nLuminarias} lumin√°rias</strong></div>
      <div class="result-item"><span>Ilumin√¢ncia resultante</span><strong>${iluminanciaReal.toFixed(0)} lux</strong></div>
      <div class="result-item"><span>Status</span><strong style="color:${iluminanciaReal>=E?'#4caf50':'#ff9800'}">${iluminanciaReal>=E?'‚úÖ Dentro da norma':'‚ö†Ô∏è Abaixo do recomendado'}</strong></div>
    </div>`;
  
  document.getElementById('resultIluminacao').innerHTML = html;
}

// ===== 3. CALCULADORA DE CURTO-CIRCUITO =====
function calcularCurtoCircuito() {
  if(checkTrialExpired()) return;
  
  const tensao = parseFloat(document.getElementById('tensaoCC').value);
  const potTrafo = parseFloat(document.getElementById('potTrafo').value);
  const impedTrafo = parseFloat(document.getElementById('impedTrafo').value) || 4;
  const secCabo = parseFloat(document.getElementById('secCaboCC').value);
  const distCabo = parseFloat(document.getElementById('distCaboCC').value);
  const tipoCC = document.getElementById('tipoCC').value;
  
  if (!tensao || !potTrafo || !secCabo || !distCabo) { alert('Preencha todos os campos!'); return; }
  
  // Imped√¢ncia do transformador (Œ©)
  const zTrafo = (impedTrafo / 100) * (tensao * tensao) / (potTrafo * 1000);
  
  // Resist√™ncia do cabo (Œ©) ‚Äî cobre, œÅ = 0.0172
  const ro = 0.0172;
  const rCabo = (ro * distCabo) / secCabo;  // ida
  const xCabo = 0; // reativo do cabo (simplificado)
  
  // Imped√¢ncia total (trif√°sico)
  const zTotal = Math.sqrt(Math.pow(zTrafo + rCabo * 2, 2));
  
  // Corrente de curto-circuito trif√°sico
  let Icc3f = tensao / (Math.sqrt(3) * zTotal);
  
  // Corrente bif√°sico e monof√°sico (aproxima√ß√µes)
  const Icc2f = Icc3f * 0.866; // ‚àö3/2
  const Icc1f = tensao / (2 * zTotal); // simplificado
  
  const resultado = tipoCC === 'trifasico' ? Icc3f 
                  : tipoCC === 'bifasico'  ? Icc2f 
                  : Icc1f;
  const nomeCC = tipoCC === 'trifasico' ? 'Trif√°sico (mais severo)' 
               : tipoCC === 'bifasico'  ? 'Bif√°sico'
               : 'Monof√°sico (fase-neutro)';
  
  // Poder de interrup√ß√£o do disjuntor recomendado
  const podInterr = resultado <= 6000 ? 6 : resultado <= 10000 ? 10 : resultado <= 15000 ? 15 : 25;
  
  const html = `
    <div class="result-box">
      <h4>‚ö° Corrente de Curto-Circuito ‚Äî ${nomeCC}</h4>
      <div class="result-item"><span>Imped√¢ncia do transformador (Zt)</span><strong>${zTrafo.toFixed(4)} Œ©</strong></div>
      <div class="result-item"><span>Resist√™ncia do cabo (Rc ida+volta)</span><strong>${(rCabo*2).toFixed(4)} Œ©</strong></div>
      <div class="result-item"><span>Imped√¢ncia total (Ztotal)</span><strong>${zTotal.toFixed(4)} Œ©</strong></div>
      <div style="border-top:2px solid var(--blue-glow);margin:0.8rem 0;"></div>
      <div class="result-item"><span>‚ö° Icc Trif√°sico</span><strong>${(Icc3f/1000).toFixed(2)} kA (${Icc3f.toFixed(0)} A)</strong></div>
      <div class="result-item"><span>‚ö° Icc Bif√°sico</span><strong>${(Icc2f/1000).toFixed(2)} kA (${Icc2f.toFixed(0)} A)</strong></div>
      <div class="result-item"><span>‚ö° Icc Monof√°sico</span><strong>${(Icc1f/1000).toFixed(2)} kA (${Icc1f.toFixed(0)} A)</strong></div>
      <div style="border-top:2px solid var(--yellow);margin:0.8rem 0;"></div>
      <div class="result-item"><span>üîí Poder de corte m√≠nimo do disjuntor</span><strong style="color:var(--yellow)">${podInterr} kA</strong></div>
    </div>`;
  
  document.getElementById('resultCurtoCircuito').innerHTML = html;
}

// ===== 4. CALCULADORA DE FATOR DE DEMANDA =====
function adicionarCargaFD() {
  const container = document.getElementById('cargasFD');
  const count = container.querySelectorAll('.carga-fd-row').length;
  const div = document.createElement('div');
  div.className = 'carga-fd-row consumo-item-row';
  div.innerHTML = `
    <div class="form-group"><label>Carga</label><input type="text" placeholder="Ex: Ar-condicionado"></div>
    <div class="form-group"><label>Pot√™ncia (W)</label><input type="number" placeholder="Ex: 2000"></div>
    <div class="form-group"><label>Qtd</label><input type="number" placeholder="1" value="1" min="1"></div>
    <div class="form-group"><label>FD (%)</label><input type="number" placeholder="Ex: 75" value="75" min="1" max="100"></div>
    <div style="padding-bottom:0.9rem;display:flex;align-items:flex-end;">
      <button class="btn btn-red" onclick="this.closest('.carga-fd-row').remove()">üóëÔ∏è</button>
    </div>`;
  container.appendChild(div);
}

function calcularFatorDemanda() {
  if(checkTrialExpired()) return;
  
  const rows = document.querySelectorAll('.carga-fd-row');
  if (!rows.length) { alert('Adicione pelo menos uma carga!'); return; }
  
  let potenciaInstalada = 0;
  let demandaMaxima = 0;
  let itens = [];
  
  rows.forEach(row => {
    const inputs = row.querySelectorAll('input');
    const nome = inputs[0].value || 'Carga';
    const pot = parseFloat(inputs[1].value) || 0;
    const qtd = parseFloat(inputs[2].value) || 1;
    const fd = parseFloat(inputs[3].value) || 75;
    
    if (pot > 0) {
      const potTotal = pot * qtd;
      const demanda = potTotal * (fd / 100);
      potenciaInstalada += potTotal;
      demandaMaxima += demanda;
      itens.push({ nome, potTotal, fd, demanda });
    }
  });
  
  if (!potenciaInstalada) { alert('Preencha as pot√™ncias das cargas!'); return; }
  
  const fdGlobal = (demandaMaxima / potenciaInstalada) * 100;
  const tensao = parseFloat(document.getElementById('tensaoFD').value) || 220;
  const correnteDemanda = demandaMaxima / tensao;
  const secoesDisponiveis = [1.5, 2.5, 4, 6, 10, 16, 25, 35, 50, 70, 95];
  const cap220 = [15.5, 21, 28, 36, 50, 68, 89, 110, 134, 170, 210];
  let secaoRec = 50;
  for(let i = 0; i < cap220.length; i++) {
    if(cap220[i] >= correnteDemanda * 1.25) { secaoRec = secoesDisponiveis[i]; break; }
  }
  const disjRec = [10,16,20,25,32,40,50,63,70,80,100].find(d => d >= correnteDemanda * 1.25) || 100;
  
  let html = `<div class="result-box"><h4>üìä Resultado ‚Äî Fator de Demanda</h4>`;
  html += `<div class="result-item"><span>Pot√™ncia Total Instalada</span><strong>${(potenciaInstalada/1000).toFixed(2)} kW</strong></div>`;
  html += `<div class="result-item"><span>Demanda M√°xima Estimada</span><strong>${(demandaMaxima/1000).toFixed(2)} kW</strong></div>`;
  html += `<div class="result-item"><span>Fator de Demanda Global</span><strong>${fdGlobal.toFixed(1)}%</strong></div>`;
  html += `<div class="result-item"><span>Corrente de demanda (${tensao}V)</span><strong>${correnteDemanda.toFixed(1)} A</strong></div>`;
  html += `<div style="border-top:2px solid var(--yellow);margin:0.8rem 0;"></div>`;
  html += `<div class="result-item"><span>Se√ß√£o recomendada</span><strong style="color:var(--yellow)">${secaoRec} mm¬≤</strong></div>`;
  html += `<div class="result-item"><span>Disjuntor recomendado</span><strong style="color:var(--yellow)">${disjRec} A</strong></div>`;
  html += `<div style="margin-top:1rem;font-size:0.82rem;color:var(--text-muted);">Detalhamento por carga:</div>`;
  itens.forEach(it => {
    html += `<div class="result-item"><span>${it.nome} (FD ${it.fd}%)</span><strong>${(it.demanda/1000).toFixed(2)} kW</strong></div>`;
  });
  html += `</div>`;
  
  document.getElementById('resultFatorDemanda').innerHTML = html;
}

// ===== 5. MODO ESCURO =====
function toggleDarkMode() {
  const root = document.documentElement;
  const btn = document.getElementById('darkModeBtn');
  const isDark = root.getAttribute('data-theme') === 'dark' || !root.getAttribute('data-theme');
  
  if (isDark) {
    // Mudar para modo claro
    root.style.setProperty('--blue-deep', '#f0f4f8');
    root.style.setProperty('--blue-mid', '#e2ecf7');
    root.style.setProperty('--blue-bright', '#1565c0');
    root.style.setProperty('--card-bg', 'rgba(255,255,255,0.92)');
    root.style.setProperty('--card-border', 'rgba(21,101,192,0.25)');
    root.style.setProperty('--text-muted', 'rgba(10,22,40,0.6)');
    document.body.style.color = '#0a1628';
    btn.textContent = 'üåô Modo Escuro';
    root.setAttribute('data-theme', 'light');
    localStorage.setItem('eletricapro_theme', 'light');
  } else {
    // Voltar para modo escuro
    root.style.setProperty('--blue-deep', '#0a1628');
    root.style.setProperty('--blue-mid', '#0d2347');
    root.style.setProperty('--blue-bright', '#1565c0');
    root.style.setProperty('--card-bg', 'rgba(13,35,71,0.85)');
    root.style.setProperty('--card-border', 'rgba(33,150,243,0.35)');
    root.style.setProperty('--text-muted', 'rgba(255,255,255,0.65)');
    document.body.style.color = '#ffffff';
    btn.textContent = '‚òÄÔ∏è Modo Claro';
    root.setAttribute('data-theme', 'dark');
    localStorage.setItem('eletricapro_theme', 'dark');
  }
}

// Aplicar tema salvo ao carregar
function initTheme() {
  const savedTheme = localStorage.getItem('eletricapro_theme');
  if (savedTheme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    toggleDarkMode();
  }
}

</script>
</body>
</html>
